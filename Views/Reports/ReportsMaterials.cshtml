@{

    ViewData["Title"] = "Reportes de Materiales";

}

<!-- Encabezado de la Página -->
<div class="app-content-header">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col-sm-6">
                <h3 class="mb-0">
                    <i class="bi bi-file-earmark-spreadsheet-fill me-2 text-success"></i>

                    Reportes de Materiales
                </h3>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-end">
                    <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Inicio</a></li>
                    <li class="breadcrumb-item active">Reportes Materiales</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<!-- Contenedor Principal -->
<div class="container-fluid mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-light border-bottom">
            <ul class="nav nav-tabs card-header-tabs" id="reportTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active fw-bold text-success" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab">
                        <i class="bi bi-chart-bar me-2"></i>General
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-bold text-primary" id="fechas-tab" data-bs-toggle="tab" data-bs-target="#fechas" type="button" role="tab">
                        <i class="bi bi-calendar-alt me-2"></i>Por Fechas
                    </button>
                </li>
            </ul>
        </div>

        <div class="card-body tab-content" id="reportTabsContent">
            <!-- Pestaña General -->
            <div class="tab-pane fade show active" id="general" role="tabpanel" aria-labelledby="general-tab">
                <div class="text-center p-4">
                    <h5 class="mb-3 text-dark fw-bold">
                        <i class="bi bi-file-earmark-excel me-2 text-success"></i>Reporte General
                    </h5>
                    <p class="text-muted mb-4">

                        Descarga el reporte completo con todos los materiales registrados en el sistema
                    </p>
                    <div class="d-grid gap-2 col-md-6 mx-auto">
                        <button type="button" class="btn btn-success" onclick="downloadGeneralReport()">
                            <i class="bi bi-download me-2"></i>Descargar Excel
                        </button>
                    </div>
                    <div class="mt-3" id="generalTimestamp"></div>
                </div>
            </div>

            <!-- Pestaña Por Fechas -->
            <div class="tab-pane fade" id="fechas" role="tabpanel" aria-labelledby="fechas-tab">
                <div class="p-4">
                    <h5 class="mb-3 text-dark fw-bold text-center">
                        <i class="bi bi-calendar-alt me-2 text-primary"></i>Reporte por Fechas
                    </h5>
                    <p class="text-muted mb-4 text-center">Genera reportes personalizados por rango de fechas</p>

                    <div class="row justify-content-center g-3">
                        <!-- Campo Fecha Inicio -->
                        <div class="col-md-4">
                            <label for="txtFechaInicio" class="form-label fw-bold text-primary">
                                <i class="bi bi-calendar-day me-2"></i>Fecha Inicio
                            </label>
                            <input type="date" id="txtFechaInicio" class="form-control form-control border-2 text-center" />
                        </div>

                        <!-- Campo Fecha Fin -->
                        <div class="col-md-4">
                            <label for="txtFechaFin" class="form-label fw-bold text-primary">
                                <i class="bi bi-calendar-day me-2"></i>Fecha Fin
                            </label>
                            <input type="date" id="txtFechaFin" class="form-control form-control border-2 text-center" />
                        </div>

                        <!-- Botón Exportar -->
                        <div class="col-12 pt-3 text-center">
                            <button type="button" class="btn btn-primary" onclick="downloadReportByDate()">
                                <i class="bi bi-file-earmark-arrow-down me-2"></i>Exportar Excel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>

        function downloadGeneralReport() {

            window.location.href = '/Reports/DownloadMaterialsGeneral';

        }

        function downloadReportByDate() {

            var fechaInicio = $('#txtFechaInicio').val();

            var fechaFin = $('#txtFechaFin').val();

            if (!fechaInicio || !fechaFin) {

                alert('Por favor selecciona ambas fechas');

                return;

            }

            window.location.href = '/Reports/DownloadMaterialsByDate?fechaInicio=' + fechaInicio + '&fechaFin=' + fechaFin;

        }
    </script>

}
